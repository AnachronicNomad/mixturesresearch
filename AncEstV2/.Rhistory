randsnpdat <- read.csv("~/GitHub/mixturesresearch/AncEstV2/randsnpdat.txt", sep="")
View(randsnpdat)
data1 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_afr.csv")
data2 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_amr.csv"); data2 = data[,2:9]
data3 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_oth.csv")
data2 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_amr.csv"); data2 = data[,2:9]
data1 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_afr.csv")
data2 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_amr.csv"); data2 = data2[,2:9]
data3 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_oth.csv")
View(data1)
View(data2)
data1$gnomadanc = rep('afr', 1000)
data2$gnomadanc = rep('amr', 1000)
data3 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_oth.csv")
data1$gnomadanc = rep('oth', 1000)
bbdat = rbind(data1, data2, data3)
data1 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_afr.csv")
data1$gnomadanc = rep('afr', 1000)
data2 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_amr.csv"); data2 = data2[,2:9]
data2$gnomadanc = rep('amr', 1000)
data3 = read.csv("C:/Users/iansa/OneDrive/Desktop/poster/blockboot_oth.csv")
data3$gnomadanc = rep('oth', 1000)
bbdat = rbind(data1, data2, data3)
View(bbdat)
bb = bbdat %>%
filter(gnomadanc == 'afr')
library(shinyWidgets)
library(ggplot2)
library(reshape2)
library(RColorBrewer)
library(scales)
library(gridExtra)
library(dplyr)
bb = bbdat %>%
filter(gnomadanc == 'afr')
View(bb)
View(bb)
bb = bbdat %>%
filter(gnomadanc == 'afr') %>%
select(european, african, south_asian, east_asian, native_american)
randmeltdat <- melt(bb)
names(randmeltdat) = c('Ancestry', 'Proportion')
randplot = ggplot(randmeltdat, aes(x=Proportion, fill = Ancestry)) +
geom_histogram(bins = 400)+
geom_density(fill = NA)+
facet_grid(Ancestry ~ .)+
scale_fill_manual(values = colvec)+
guides(fill = FALSE)+
scale_x_continuous(breaks = c(0,.25,.50,.75,1),
limits = c(-0.01,1)) +
theme(axis.text.x = element_text(size=15),
axis.title.x = element_text(size=15),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
strip.text.y = element_text(size = 15),
axis.ticks = element_blank())
colvec = c(brewer.pal(n = 8, name = 'Set2')[2],
brewer.pal(n = 8, name = 'Set2')[3],
brewer.pal(n = 8, name = 'Set2')[1],
brewer.pal(n = 8, name = 'Set2')[5],
brewer.pal(n = 8, name = 'Set2')[6])
randplot = ggplot(randmeltdat, aes(x=Proportion, fill = Ancestry)) +
geom_histogram(bins = 400)+
geom_density(fill = NA)+
facet_grid(Ancestry ~ .)+
scale_fill_manual(values = colvec)+
guides(fill = FALSE)+
scale_x_continuous(breaks = c(0,.25,.50,.75,1),
limits = c(-0.01,1)) +
theme(axis.text.x = element_text(size=15),
axis.title.x = element_text(size=15),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
strip.text.y = element_text(size = 15),
axis.ticks = element_blank())
plot(randplot)
bbsum = bb %>%
summarise_each(bb, funs(mean))
bbsum = bb %>%
summarise_each(bb, funs(mean))
?summarise_each
bbsum = bb %>%
summarise_all(bb, mean)
bbsum = bb %>%
summarise_all(mean)
View(bbsum)
bbsum = melt(bbsum)
View(bbsum)
View(bbsum)
bbplot = ggplot(bbsum, aes(x = value, fill = variable)) +
geom_bar(position = fill)
bbplot = ggplot(bbsum, aes(x = value, fill = variable)) +
geom_bar(position = 'fill')
plot(bbplot)
bb = bbdat %>%
filter(gnomadanc == 'amr') %>%
select(european, african, south_asian, east_asian, native_american)
bbsum = bb %>%
summarise_all(mean)
bbsum = melt(bbsum)
bbplot = ggplot(bbsum, aes(x = value, fill = variable)) +
geom_bar(position = 'fill')
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = value, fill = variable)) +
geom_bar(position = 'fill', stat = 'identity')
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = value, fill = variable)) +
geom_bar(position = 'fill') +
scale_x_continuous(labels = scales::percent_format())
plot(bbplot)
bbplot = ggplot(bbsum, aes(y = value, fill = variable)) +
geom_bar(position = 'fill') +
scale_x_continuous(labels = scales::percent_format())
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = value, fill = variable)) +
geom_bar(position = 'fill') +
scale_x_continuous(labels = scales::percent_format())
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = variable, y = value, fill = variable)) +
geom_bar(position = 'fill')
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = variable, y = value)) +
geom_col()
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = variable, fill = value)) +
geom_bar(position = fill)
bbplot = ggplot(bbsum, aes(x = variable, fill = value)) +
geom_bar(position = 'fill')
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = variable, fill = value)) +
geom_bar(position = 'fill')+
coord_flip()
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = variable, y = value)) +
geom_col()
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = variable, y = value)) +
scale_fill_manual(values = colvec)+
geom_col()
plot(bbplot)
?geom_col
bbplot = ggplot(bbsum, aes(x = variable, y = value)) +
geom_col(position = 'stack')
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = variable, y = value)) +
geom_col(color = colvec)
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = variable, y = value)) +
geom_col(fill = colvec)
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = variable, y = value)) +
geom_col(fill = colvec, color = 'black')
plot(bbplot)
bbplot = ggplot(bbsum, aes(x = variable, y = value)) +
geom_col(fill = colvec) +
scale_y_continuous(breaks = c(0,.25,.50,.75,1),
limits = c(0,1))
plot(bbplot)
